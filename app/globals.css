@import "tailwindcss";
@plugin "@tailwindcss/typography";

@custom-variant dark (&:where(.dark, .dark *));

@theme {
  --color-primary-50: #eef2ff;
  --color-primary-100: #e0e7ff;
  --color-primary-200: #c7d2fe;
  --color-primary-300: #a5b4fc;
  --color-primary-400: #818cf8;
  --color-primary-500: #6366f1;
  --color-primary-600: #4f46e5;
  --color-primary-700: #4338ca;
  --color-primary-800: #3730a3;
  --color-primary-900: #312e81;
  --color-primary-950: #1e1b4b;

  --color-violet-50: #f5f3ff;
  --color-violet-100: #ede9fe;
  --color-violet-200: #ddd6fe;
  --color-violet-300: #c4b5fd;
  --color-violet-400: #a78bfa;
  --color-violet-500: #8b5cf6;
  --color-violet-600: #7c3aed;
  --color-violet-700: #6d28d9;
  --color-violet-800: #5b21b6;
  --color-violet-900: #4c1d95;
  --color-violet-950: #2e1065;

  --color-surface-0: #ffffff;
  --color-surface-50: #f8fafc;
  --color-surface-100: #f1f5f9;
  --color-surface-200: #e2e8f0;
  --color-surface-300: #cbd5e1;
  --color-surface-400: #94a3b8;
  --color-surface-500: #64748b;
  --color-surface-600: #475569;
  --color-surface-700: #334155;
  --color-surface-800: #1e293b;
  --color-surface-900: #0f172a;
  --color-surface-950: #020617;

  --color-dark-bg: #0B1120;
  --color-dark-surface: #111827;
  --color-dark-border: #1e293b;

  --font-sans: "Inter", ui-sans-serif, system-ui, sans-serif;
  --font-mono: "JetBrains Mono", ui-monospace, monospace;
}

/* Base styles */
html {
  scroll-behavior: smooth;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  @apply bg-white text-surface-900 dark:bg-dark-bg dark:text-surface-200;
  font-feature-settings: "cv02", "cv03", "cv04", "cv11";
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  @apply bg-transparent;
}

::-webkit-scrollbar-thumb {
  @apply bg-surface-300 dark:bg-surface-700 rounded-full;
}

::-webkit-scrollbar-thumb:hover {
  @apply bg-surface-400 dark:bg-surface-600;
}

/* Code block styles */
[data-rehype-pretty-code-figure] {
  @apply relative my-6;
}

[data-rehype-pretty-code-figure] pre {
  @apply overflow-x-auto rounded-xl border border-surface-200 bg-surface-50 px-0 py-4 text-sm leading-relaxed dark:border-dark-border dark:bg-dark-surface;
}

[data-rehype-pretty-code-figure] code {
  @apply grid;
}

[data-rehype-pretty-code-figure] [data-line] {
  @apply border-l-2 border-transparent px-5;
}

[data-rehype-pretty-code-figure] [data-highlighted-line] {
  @apply border-l-primary-400 bg-primary-50/50 dark:border-l-primary-500 dark:bg-primary-950/30;
}

[data-rehype-pretty-code-title] {
  @apply rounded-t-xl border border-b-0 border-surface-200 bg-surface-100 px-5 py-3 text-xs font-medium text-surface-600 dark:border-dark-border dark:bg-surface-800 dark:text-surface-400;
}

[data-rehype-pretty-code-title] + pre {
  @apply rounded-t-none;
}

/* Inline code */
:not(pre) > code {
  @apply rounded-md border border-surface-200 bg-surface-50 px-1.5 py-0.5 text-sm font-medium text-primary-700 dark:border-dark-border dark:bg-surface-800 dark:text-primary-300;
}

/* Focus styles */
*:focus-visible {
  @apply outline-2 outline-offset-2 outline-primary-500;
}

/* Selection */
::selection {
  @apply bg-primary-200 text-primary-900 dark:bg-primary-800 dark:text-primary-100;
}

/* Smooth transitions for theme changes */
* {
  @apply transition-colors duration-75;
}

/* Prevent transition flash on page load */
html:not(.theme-loaded) * {
  transition: none !important;
}

/* Typography plugin overrides */
.prose {
  --tw-prose-body: var(--color-surface-700);
  --tw-prose-headings: var(--color-surface-900);
  --tw-prose-links: var(--color-primary-600);
  --tw-prose-code: var(--color-primary-700);
  --tw-prose-pre-bg: var(--color-surface-50);
  --tw-prose-th-borders: var(--color-surface-200);
  --tw-prose-td-borders: var(--color-surface-200);

  --tw-prose-invert-body: var(--color-surface-300);
  --tw-prose-invert-headings: var(--color-surface-100);
  --tw-prose-invert-links: var(--color-primary-400);
  --tw-prose-invert-code: var(--color-primary-300);
  --tw-prose-invert-pre-bg: var(--color-dark-surface);
  --tw-prose-invert-th-borders: var(--color-dark-border);
  --tw-prose-invert-td-borders: var(--color-dark-border);
}

.prose :where(h2):not(:where([class~="not-prose"],[class~="not-prose"] *)) {
  @apply scroll-mt-24;
}

.prose :where(h3):not(:where([class~="not-prose"],[class~="not-prose"] *)) {
  @apply scroll-mt-24;
}

.prose :where(a):not(:where([class~="not-prose"],[class~="not-prose"] *)) {
  @apply font-medium no-underline hover:underline;
}

.prose :where(thead):not(:where([class~="not-prose"],[class~="not-prose"] *)) {
  @apply border-b border-surface-200 dark:border-dark-border;
}

.prose :where(tbody tr):not(:where([class~="not-prose"],[class~="not-prose"] *)) {
  @apply border-b border-surface-100 dark:border-surface-800;
}

/* CE gradient animation */
@keyframes ce-gradient {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.ce-gradient-animated {
  background: linear-gradient(135deg, var(--color-violet-500), var(--color-primary-500), var(--color-violet-600));
  background-size: 200% 200%;
  animation: ce-gradient 6s ease infinite;
}

/* Sparkle animation */
@keyframes sparkle {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.sparkle {
  animation: sparkle 2s ease-in-out infinite;
}
